# Настройка Webhook для Telegram бота

## Описание

Для работы команд бота-администратора необходимо настроить webhook, который будет получать обновления от Telegram Bot API.

## Шаги настройки

### 1. Получите URL вашего приложения на Render

После деплоя на Render вы получите URL вида: `https://smm-experttraveler.onrender.com`

### 2. Установите webhook через Telegram Bot API

Используйте следующий запрос (замените `YOUR_BOT_TOKEN` на ваш токен бота и `YOUR_APP_URL` на URL вашего приложения):

```bash
curl -X POST "https://api.telegram.org/botYOUR_BOT_TOKEN/setWebhook?url=https://YOUR_APP_URL/webhook"
```

Или через браузер:
```
https://api.telegram.org/botYOUR_BOT_TOKEN/setWebhook?url=https://YOUR_APP_URL/webhook
```

### 3. Проверьте установку webhook

Проверьте, что webhook установлен правильно:

```bash
curl "https://api.telegram.org/botYOUR_BOT_TOKEN/getWebhookInfo"
```

### 4. Протестируйте команды

Отправьте команду `/help` боту в личные сообщения (используя `ADMIN_CHAT_ID`). Бот должен ответить списком доступных команд.

## Доступные команды бота

- `/start` или `/help` - Показать список всех команд
- `/schedule` - Показать текущее расписание публикаций
- `/settime HH:MM` - Установить время следующей публикации (например: `/settime 14:30`)
- `/setfreq N` - Установить частоту публикаций в часах (например: `/setfreq 24`)
- `/stats` - Показать статистику вовлеченности за последние 7 дней
- `/stats N` - Показать статистику за последние N дней
- `/groups` - Список групп для публикаций (управление группами)
- `/setgroup ID` - Выбрать активную группу для публикаций
- `/addgroup` - Добавить группу (отправьте в чате группы, где бот администратор)
- `/nextpost` - Показать информацию о следующем запланированном посте

Публикации по расписанию выполняются автоматически фоновым планировщиком (проверка раз в минуту). Сгенерированные посты сохраняются в `data/generated_posts/` и `data/last_post.json`.

## Важные замечания

1. **Безопасность**: Webhook принимает обновления от любого источника. В production рекомендуется добавить проверку секретного токена.

2. **ADMIN_CHAT_ID**: Убедитесь, что переменная окружения `ADMIN_CHAT_ID` установлена в Render и содержит ваш Telegram chat ID.

3. **Права бота**: Бот должен иметь права администратора в группе для публикации постов.

## Отключение webhook

Если нужно отключить webhook:

```bash
curl -X POST "https://api.telegram.org/botYOUR_BOT_TOKEN/deleteWebhook"
```
